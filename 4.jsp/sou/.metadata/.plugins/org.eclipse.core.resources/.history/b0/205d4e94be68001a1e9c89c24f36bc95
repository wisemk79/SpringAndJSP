package action;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
//추가
import lys.board.*;
import java.util.*;

// /list.do=action.ListAction
//각 액션클래스에서 공통으로 사용하는 메서드를 사용하기위해서 상속(CommandAction)
public class ListAction implements CommandAction {

	@Override
	public String requestPro(HttpServletRequest request, HttpServletResponse response) throws Throwable {
		// TODO Auto-generated method stub
		
		   List articleList=null;//화면에 출력할 레코드를 저장할 변수
		   BoardDAO dbPro=new BoardDAO();
		   count=dbPro.getArticleCount();//select count(*) from board=>getMemberList()
		   System.out.println("현재 레코드수(count)=>"+count);
		   
		   if(count > 0){                       //startRow,endRow(X)=>pageSize(O)
			   articleList=dbPro.getArticles(startRow, pageSize);//첫번째 레코드번호, 끊어서보여줄갯수
		   }else {
			   articleList=Collections.EMPTY_LIST;//아무것도 없는 빈 list객체 반환
		   }
		   //            122-(1-1)*10=>122,121,120,,,
		   //            122-(2-1)*10=>122-10=>112,111,110,,,
		   number=count-(currentPage-1)*pageSize;
		   System.out.println("페이지별 number=>"+number);
	
		//2.처리결과->list.jsp에게 전달(메모리에 저장->공유시키기 위해서)->request에 저장
		   request.setAttribute("currentPage", currentPage);//int->new Integer(currentPage)
		   request.setAttribute("startRow", startRow);
		   request.setAttribute("count", count);
		   request.setAttribute("pageSize", pageSize);
		   request.setAttribute("blockSize", blockSize);
		   request.setAttribute("number", number);
		   request.setAttribute("articleList", articleList);
		//3.이동할 페이지명 지정->return "경로포함해서 이동할 페이지명";
		return "/list.jsp";//Controller->/list.jsp->꺼내와서 출력
	}
}

